var matlock={url:window.location.href,timerStatus:0,currentTime:0,userStatus:null,runtime:null,totalTime:null,event:{},logging:0,timeline:"",hashid:null,startTimer:function(){this.timerStatus=1,1==this.logging&&console.log("The timer was started at "+this.currentTime+" seconds."),null!==this.runtime&&clearTimeout(this.runtime),this.incrementTimer()},incrementTimer:function(){var t=this;return 0!=this.timerStatus?(runtime=setInterval(function(){t.currentTime++,t.checkTimer(),1==this.logging&&console.log(t.currentTime)},1e3),t.runtime=runtime):void this.stopTimer()},stopTimer:function(){var t=clearInterval(this.runtime);return t&&1==this.logging&&console.log("Timer was stopped at "+this.currentTime),1==this.logging&&console.log("Timer status was set to 0"),this.timerStatus=0},resumeTimer:function(t){this.currentTime="undefined"!=typeof t?t:this.currentTime,this.setTimer(this.currentTime),this.startTimer()},setTimer:function(t){return 1==this.logging&&console.log("Timer value was manually set to "+t),this.currentTime=t},setUserStatus:function(t){return 1==this.logging&&console.log("User status was set to "+t),this.userStatus=t},getUserStatus:function(){return this.userStatus},toggleOutput:function(t){return this.logging=t},buildTimeline:function(t){var e="";e+="switch(this.currentTime){";for(var i=0;i<t.length;i++){var n=t[i];e+="case "+n.value+":",e+="(function(){ ",e+=this.event[n.key].eventCallback,e+="})();",e+="break;"}return e+="default:",e+="if(this.logging == 1) {",e+='console.log("Ping.")',e+="}",e+="}",this.timeline=e},checkTimer:function(){return eval(this.timeline),1==this.logging&&console.log("time was checked, it is "+this.currentTime),this.currentTime},sortEvents:function(t){var e=[];for(key in t)t.hasOwnProperty(key)&&e.push({key:key,value:t[key].triggerOn});return e.sort(function(t,e){return t.value-e.value}),e},request:function(t,e,i){var n=new XMLHttpRequest;n.open(t,e),"undefined"==typeof i||null===i?n.send(null):n.send(i),n.onreadystatechange=function(){if(4===n.readyState){if(200===n.status)return console.log(n.responseText),n.responseText;console.log("Error: "+n.status)}}},bakeCookie:function(){var t="matlock",e={url:this.url,currentTime:this.currentTime,status:this.timerStatus},i=t+"="+JSON.stringify(e);document.cookie=i,console.log("Data saved to document.cookie!")},readCookie:function(t){},listenOutbound:function(){console.log("matlock is listening for outbound requests..."),window.addEventListener("beforeunload",function(t){console.log("User is leaving the web page..."),this.request("POST","/",{url:this.url,totaltime:this.currentTime})})},init:function(){this.startTimer(),this.toggleOutput(1);this.listenOutbound();var t=this.sortEvents(this.event);this.buildTimeline(t)}},m=matlock.init();